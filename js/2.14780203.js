(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{c3c9:function(i,e,t){"use strict";t.r(e);var a=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"relative-position",style:i.visible?"height: 92Vh":""},[t("div",{staticClass:"row q-pa-lg"},[t("div",{staticClass:"col-12 col-md-6 q-px-md",style:i.$q.screen.lt.md?"order:2":""},[t("q-form",{staticClass:"q-gutter-sm",on:{submit:i.botonGuardarEditar}},[t("q-input",{attrs:{filled:"",label:"Nombre de la Clinica",rules:i.rules},model:{value:i.nombre,callback:function(e){i.nombre=e},expression:"nombre"}}),t("q-input",{attrs:{filled:"",rules:i.rules,label:"Telefono",mask:"#### - ####",hint:"#### - ####"},model:{value:i.telefono,callback:function(e){i.telefono=e},expression:"telefono"}}),t("q-input",{attrs:{filled:"",label:"Pais",rules:i.rules},model:{value:i.direccion.pais,callback:function(e){i.$set(i.direccion,"pais",e)},expression:"direccion.pais"}}),t("q-input",{attrs:{filled:"",label:"Departamento",rules:i.rules},model:{value:i.direccion.departamento,callback:function(e){i.$set(i.direccion,"departamento",e)},expression:"direccion.departamento"}}),t("div",{staticClass:"row"},[t("div",{staticClass:"col q-pr-sm"},[t("q-input",{attrs:{filled:"",label:"Municipio",rules:i.rules},model:{value:i.direccion.municipio,callback:function(e){i.$set(i.direccion,"municipio",e)},expression:"direccion.municipio"}})],1),t("div",{staticClass:"col q-pl-sm"},[t("q-input",{attrs:{filled:"",label:"Departamento",rules:i.rules},model:{value:i.direccion.codigoPostal,callback:function(e){i.$set(i.direccion,"codigoPostal",e)},expression:"direccion.codigoPostal"}})],1)]),t("q-input",{attrs:{filled:"",label:"Colonia",rules:i.rules},model:{value:i.direccion.colonia,callback:function(e){i.$set(i.direccion,"colonia",e)},expression:"direccion.colonia"}}),t("q-input",{attrs:{filled:"",label:"Calle",rules:i.rules},model:{value:i.direccion.calle,callback:function(e){i.$set(i.direccion,"calle",e)},expression:"direccion.calle"}}),t("q-input",{attrs:{filled:"",label:"Punto de referencia",hint:"Campo Opcional"},model:{value:i.direccion.referencia,callback:function(e){i.$set(i.direccion,"referencia",e)},expression:"direccion.referencia"}}),t("div",{staticClass:"q-mt-md"},[t("q-btn",{attrs:{label:"Guardar",type:"submit",color:"primary"}}),t("q-btn",{staticClass:"q-ml-sm",attrs:{label:"Cancelar",to:"/clinicas",color:"red",flat:""}})],1)],1)],1),t("div",{staticClass:"col-12 col-md-6 q-px-md",class:i.$q.screen.lt.md?"q-mb-md":"",style:i.$q.screen.lt.md?"order:1":""},[t("div",{staticClass:"row q-mb-sm items-start"},[t("div",{staticClass:"col-10"},[t("q-input",{attrs:{filled:"",label:"Buscar Direccion",hint:"Presione la tecla Enter para buscar"},on:{keydown:function(e){return!e.type.indexOf("key")&&i._k(e.keyCode,"enter",13,e.key,"Enter")?null:i.fowardGeocoding.apply(null,arguments)}},model:{value:i.buscarDireccion,callback:function(e){i.buscarDireccion=e},expression:"buscarDireccion"}})],1),t("div",{staticClass:"col-2 text-center"},[t("q-btn",{attrs:{size:"lg",icon:"my_location",round:"",color:"blue-10"},on:{click:i.getCurrentLocation}},[t("q-tooltip",[i._v("Ver Ubicacion Actual")])],1)],1)]),t("q-card",{staticClass:"full-width",staticStyle:{flex:"1",width:"100em"},attrs:{flat:""}},[i.showMap?t("l-map",{ref:"map",staticStyle:{"z-index":"0",height:"70vh",width:"100%"},attrs:{zoom:i.zoom,center:i.center},on:{click:i.updateMarker}},[t("l-tile-layer",{attrs:{url:i.url,attribution:i.attribution}}),t("l-marker",{attrs:{"lat-lng":i.marker,icon:i.defaultMarkerIcon}})],1):i._e()],1),t("q-banner",{staticClass:"bg-positive text-white q-mt-md q-mb-sm",staticStyle:{"border-left":"5px solid #0d9403"},attrs:{dense:"",rounded:""},scopedSlots:i._u([{key:"avatar",fn:function(){return[t("q-icon",{attrs:{name:"priority_high",color:"white"}})]},proxy:!0}])},[t("span",{staticClass:"text-weight-bold"},[i._v("\n          La busqueda solo cubre el territorio de El Salvador\n        ")])]),t("q-banner",{staticClass:"bg-warning text-white",staticStyle:{"border-left":"5px solid #fca103"},attrs:{dense:"",rounded:""},scopedSlots:i._u([{key:"avatar",fn:function(){return[t("q-icon",{attrs:{name:"warning",color:"white"}})]},proxy:!0}])},[t("span",{staticClass:"text-weight-bold"},[i._v("\n          Por favor coloque el marcador en la ubicacion deseada\n        ")])])],1)]),t("q-inner-loading",{attrs:{showing:i.visible}},[t("q-spinner-cube",{attrs:{size:"3rem",color:"primary"}}),t("span",{staticClass:" text-primary\n      text-uppercase\n      text-overline\n      text-weight-bold"},[i._v("Cargando Clinica")])],1)],1)},c=[],o=(t("ddb0"),t("fc1b")),r=t("2699"),n=t("4e2b"),l=t("a40a"),s=t("6397"),d=t.n(s),u=t("e11e"),h=t("bc3a"),p=t.n(h),b={name:"Agregar_Editar_Clinica",components:{LMap:r["a"],LMarker:n["a"],LTileLayer:l["a"]},data(){return{visible:!0,zoom:17,center:Object(u["latLng"])(0,0),url:"http://{s}.tile.osm.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors: Geolocation by  <a href="https://locationiq.com/attribution">LocationIQ</a> ',marker:Object(u["latLng"])(0,0),defaultMarkerIcon:new u["Icon"]({iconUrl:d.a,iconSize:[25,41],iconAnchor:[12,41]}),showMap:!0,rules:[i=>!!i||"Se requiere llenar el campo",i=>!/(^\s+)|(\s+$)/.test(i)||"No se permiten espacion en blanco al principio y final"],nombre:"",telefono:"",direccion:{pais:"",departamento:"",municipio:"",codigoPostal:"",colonia:"",calle:"",referencia:"",lat:"",lng:""},direccionApi:{},buscarDireccion:""}},async created(){null!=this.$route.params.id?await this.obtenerClinica():await this.getCurrentLocation(),this.visible=!1},methods:{async updateMarker(i){this.direccion.lat=i.latlng.lat,this.direccion.lng=i.latlng.lng,this.marker=Object(u["latLng"])(this.direccion.lat,this.direccion.lng),this.center=Object(u["latLng"])(this.direccion.lat,this.direccion.lng),await this.reverseGeocoding()},async getCurrentLocation(){try{var i=await this.$getLocation({});this.marker=Object(u["latLng"])(i.lat,i.lng),this.center=Object(u["latLng"])(i.lat,i.lng),this.direccion.lat=i.lat,this.direccion.lng=i.lng,this.zoom=17,this.$refs.map.mapObject.setView(this.center,this.zoom),await this.reverseGeocoding()}catch(e){console.error(e),alert(e)}},async reverseGeocoding(){var i=await p.a.get("https://us1.locationiq.com/v1/reverse.php?key=pk.cb6782b8b417bd7495da5c64a0c8780f&lat="+this.direccion.lat+"&lon="+this.direccion.lng+"&format=json");this.direccionApi=i.data.address,this.llenarDireccion()},async fowardGeocoding(){try{var i=await p.a.get("https://us1.locationiq.com/v1/search.php?key=pk.cb6782b8b417bd7495da5c64a0c8780f&q="+encodeURI(this.buscarDireccion)+"&limit=1&countrycodes=sv&format=json");this.direccion.lat=i.data[0].lat,this.direccion.lng=i.data[0].lon,this.marker=Object(u["latLng"])(this.direccion.lat,this.direccion.lng),this.center=Object(u["latLng"])(this.direccion.lat,this.direccion.lng),await this.reverseGeocoding()}catch(e){console.error(e)}},llenarDireccion(){this.direccion.pais=this.direccionApi.country,this.direccion.departamento=this.direccionApi.state,this.direccion.municipio=this.direccionApi.county,this.direccion.calle=this.direccionApi.road,this.direccion.codigoPostal=this.direccionApi.postcode,null==this.direccionApi.neighbourhood?this.direccion.colonia=this.direccionApi.suburb:null==this.direccionApi.suburb?this.direccion.colonia=this.direccionApi.neighbourhood:this.direccion.colonia=this.direccionApi.neighbourhood+", "+this.direccionApi.suburb},async guardarClinica(){try{await o["b"].collection("clinicas").add({idMedico:o["a"].currentUser.uid,nombre:this.nombre,telefono:this.telefono,direccion:this.direccion});this.$q.notify({message:"Se creo la clinica satisfactoriamente",color:"green",icon:"check_circle"}),this.$router.push("/clinicas")}catch(i){console.error(i),this.$q.notify({message:"Se produjo un error al crear la clinica",color:"red",icon:"error"})}},async obtenerClinica(){try{const i=await o["b"].collection("clinicas").doc(this.$route.params.id).get();this.nombre=i.data().nombre,this.telefono=i.data().telefono,this.direccion=i.data().direccion,this.marker=Object(u["latLng"])(this.direccion.lat,this.direccion.lng),this.center=Object(u["latLng"])(this.direccion.lat,this.direccion.lng),this.$refs.map.mapObject.setView(this.center,17)}catch(i){console.error(i)}},async editarClinica(){try{await o["b"].collection("clinicas").doc(this.$route.params.id).update({nombre:this.nombre,telefono:this.telefono,direccion:this.direccion});const e=await o["b"].collection("pacientes").where("clinica.id","==",this.$route.params.id).get();for(var i of e.docs){await o["b"].collection("pacientes").doc(i.id).update({clinica:{id:this.$route.params.id,nombre:this.nombre,telefono:this.telefono,direccion:this.direccion}})}this.$q.notify({message:"Se edito la clinica satisfactoriamente",color:"green",icon:"check_circle"}),this.$router.push("/clinicas")}catch(e){console.error(e),this.$q.notify({message:"Se produjo un error al editar la clinica",color:"red",icon:"error"})}},async botonGuardarEditar(){null!=this.$route.params.id?await this.editarClinica():await this.guardarClinica()}}},m=b,f=t("2877"),g=t("0378"),y=t("27f9"),v=t("9c40"),q=t("05c0"),w=t("f09f"),k=t("54e1"),C=t("0016"),x=t("74f7"),$=t("a6a3"),L=t("eebe"),j=t.n(L),A=Object(f["a"])(m,a,c,!1,null,"5bfeacba",null);e["default"]=A.exports;j()(A,"components",{QForm:g["a"],QInput:y["a"],QBtn:v["a"],QTooltip:q["a"],QCard:w["a"],QBanner:k["a"],QIcon:C["a"],QInnerLoading:x["a"],QSpinnerCube:$["a"]})}}]);